---
title: 6-4 再谈TopK问题
date: 2020-10-07 11:18:42
tags:
categories:
---

回想起面试字节的时候， TopK 问题答的是一坨屎， 主要是时间复杂度弄错了……

## 一、 排序解决

快排 考虑最坏的情况 nlogn ， 性能比快排好的话，小于这个时间复杂度



## 二、 堆排序回顾


使用堆排序，我们需要 “建堆” ，O(n)遍历所有元素入堆， 入堆的过程 O(logn) 。 

如果对所有元素执行全量，入堆操作， nlogn , 等于没有做优化。

所以， 堆排序的优化在于：只维护一个 k 大小的堆。 


## 三、堆排序与TopK


如果只维护一个 k 大小的堆， 还是所有的元素需要入堆， 遍历元素需要O(n)， 但是入堆操作被优化到了 O(logK) ， 所以这道题的标准答案是堆排序可以做到 O(nlogK)， 由于 k 是个常数也可以视为 O(n) 算法。


## 四、大数据排序问题

所以， 问题诸如：

1、一亿个数据（内存能读下）， 取前20条热点数据？ 

维护一个 k 为 20 的堆。

2、100亿数据（内存存不下），取热点20w条？

同理维护一个20w数据量的堆， 流式遍历 100亿条数据。

当然，我们也可以使用分治的思想，进行外部排序： 比如我本机内存能装下 1 亿数据，那么就将 100 亿数据拆成 100 份， 每份1亿数据进行 Top20w 把结果存起来。存了一百份结果就是 2000w 数据， 此时发现是可以存入内存进行排序（内存上限 1 亿）。 所以， 将结果存起来在 2000w 中取 Top20w 。 